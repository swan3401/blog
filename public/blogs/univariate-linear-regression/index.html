<!DOCTYPE html>
<html lang="en" class="dark">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Univariate Linear Regression - Hafizulloh Ergashev</title>
        


        <script>
            tailwind.config = {
              darkMode: 'class',
              plugins: [tailwindcssTypography],
            }
        </script>
        <script src="https://cdn.tailwindcss.com?plugins=typography"></script>


        
        <link rel="apple-touch-icon" sizes="180x180" href="https://example.dev/favicon_io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://example.dev/favicon_io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://example.dev/favicon_io/favicon-16x16.png">
        <link rel="manifest" href="https://example.dev/favicon_io/site.webmanifest">        
        <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
        <link rel="preload" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" as="style">
        
        
        <style>
            html, body {
                background-color: #121212;
                color: #f3f4f6;
            }            
            .border {
                border-color: #374151;
            }            
            .carousel-item {
                display: inline-block;
                margin: 0 1rem;
            }            
            .flex {
                display: flex;
            }
            .flex-col {
                flex-direction: column;
            }
            
            @media (min-width: 768px) {
                .md\:flex-row {
                    flex-direction: row;
                }
            }
            
            .tech-carousel {
                overflow: hidden;
                width: 100%;
                padding: 1rem 0;
            }
            
            .carousel-track {
                white-space: nowrap;
            }
        </style>
        
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
        <script>
            
            if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        </script>
        <style>
            :root {
                color-scheme: dark;
            }
            
            body {
                @apply bg-[#121212] text-gray-100;
            }

            .tech-icon {
                filter: grayscale(100%) brightness(200%);
                transition: all 0.3s ease;
            }
            .tech-icon:hover {
                filter: none;
            }
            
            @keyframes scroll {
                0% {
                    transform: translateX(0);
                }
                100% {
                    transform: translateX(-100%);
                }
            }
            
            .tech-carousel {
                width: 100%;
                padding: 1rem 0;
            }
            
            .tech-track {
                width: fit-content;
                animation: scroll 20s linear infinite;
            }
            
            .tech-track:hover {
                animation-play-state: paused;
            }
            
            .tech-slide {
                float: left;
            }
        </style>

        

        
        








  <script>
    window.MathJax = {
      loader: { 
        load: ['input/tex', 'output/chtml', 'ui/menu'] 
      },
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)'], ['(|','|)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        tags: 'ams',
        macros: {
          brk: '\\allowbreak'
        },
        
        
        
        
        
        
        
        
        
        
      },
      chtml: {
        
        displayAlign: 'center',
        displayIndent: '0',
        displayOverflow: 'linebreak',
        linebreaks: {
          automatic: true,
          width: 'container',
          lineleading: 0.2,
          
          
          
          
          
          
          
          
        }
      },
      svg: {
        linebreaks: { automatic: true }
      }
    };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.3/tex-mml-chtml.js"></script>
    

    






        

    </head>
    <body class="min-h-screen bg-[#121212] text-gray-100">
        
<head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C0RTF18BT4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-C0RTF18BT4');
    </script>
    
    <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
        }
    </style>
</head>
<header class="py-6 relative">
    <div class="max-w-6xl mx-auto px-4">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="flex justify-between items-center">
                <a href="https://example.dev/" class="text-xl font-bold text-white hover:text-gray-300 transition-colors duration-300">
                    Hafizulloh Ergashev
                </a>
                
                <button id="mobile-menu-button" class="md:hidden text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>            
            
            <nav class="hidden md:flex flex-wrap justify-center items-center gap-4 md:gap-6">
                
                
                <a href="https://example.dev/about/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="https://example.dev/blogs/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="https://example.dev/contact/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="hidden md:flex justify-end">
                <div class="flex items-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>

    
    <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden transition-all duration-300">
        <div class="flex flex-col h-full">
            <div class="flex justify-between items-center p-6 border-b border-gray-800">
                <span class="text-xl font-bold text-white">Menu</span>
                <button id="mobile-menu-close" class="text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <nav class="flex flex-col p-6 space-y-4">
                
                <a href="https://example.dev/about/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="https://example.dev/blogs/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="https://example.dev/contact/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="mt-auto p-6 border-t border-gray-800">
                <div class="flex items-center justify-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="mobile-local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
    
    function updateLocalTime() {
        const timeElements = document.querySelectorAll('#local-time, #mobile-local-time');
        timeElements.forEach(element => {
            if (element) {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                element.textContent = timeString;
            }
        });
    }
    updateLocalTime();
    setInterval(updateLocalTime, 1000);

    
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const mobileMenu = document.getElementById('mobile-menu');

    function toggleMobileMenu() {
        const isHidden = mobileMenu.classList.contains('hidden');
        if (isHidden) {
            mobileMenu.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; 
        } else {
            mobileMenu.classList.add('hidden');
            document.body.style.overflow = ''; 
        }
    }

    mobileMenuButton.addEventListener('click', toggleMobileMenu);
    mobileMenuClose.addEventListener('click', toggleMobileMenu);

    
    const mobileMenuLinks = mobileMenu.querySelectorAll('a');
    mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
            toggleMobileMenu();
        });
    });

    
    const themeToggleBtn = document.getElementById('theme-toggle');
    if (themeToggleBtn) {
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
            themeToggleDarkIcon.classList.add('hidden');
        } else {
            themeToggleLightIcon.classList.add('hidden');
            themeToggleDarkIcon.classList.remove('hidden');
        }

        themeToggleBtn.addEventListener('click', function() {
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });
    }
</script> 
        <main>
            
    <div class="w-full md:w-4/5 lg:w-3/4 xl:w-2/3 mx-auto py-12">
        <div class="max-w-5xl mx-auto p-8 border border-gray-800 rounded-2xl bg-[#121212]">
            <h1 class="text-4xl font-bold mb-4">Univariate Linear Regression</h1>
            
                <div class="flex items-center gap-4 mb-8 text-gray-400">
                    <time datetime="2025-04-17">April 17, 2025</time>
                    <div class="flex gap-2">
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Generalized Linear Models</span>
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Linear regression</span>
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Gradient Descent</span>
                        
                    </div>
                </div>
            

            
              
            <div class="prose prose-invert max-w-none post-content">
                <p><strong>Univariate linear regression</strong> is a statistical technique that models the relationship between a single independent variable and a single dependent variable.</p>
<p>Such a model can be utilised to predict a dependent variable for a given independent variable.</p>
<blockquote>
<p>The term <em>&lsquo;univariate&rsquo;</em> simply means &lsquo;one variable&rsquo;</p></blockquote>
<p>Examples of such relationships might include:</p>
<ul>
<li>Egg size and required boiling time</li>
<li>Laundry size and required amount of detergent</li>
<li>Height and weight</li>
</ul>
<p>The model is expressed as:</p>
$$
\begin{aligned}
  h(x) = wx + b
\end{aligned}
$$<p>where:</p>
<ul>
<li><em><strong>w</strong></em> and <em><strong>b</strong></em> are constant numbers.</li>
<li><em><strong>x</strong></em> is an independent variable (e.g. egg size, laundry size, height). <br>
<em><strong>x</strong></em> is an input for the model.<br>
Also called <em>regressor</em>, <em>predictor</em>, <em>explanatory variable</em>, <em>feature</em>.</li>
<li><em><strong>h(x)</strong></em> is a dependent variable (e.g. time, amount of detergent, weight).<br>
This is the variable that is predicted using the model.<br>
The letter &lsquo;h&rsquo; here refers to the term <em>&lsquo;hypothesis&rsquo;</em>. <strong>Hypothesis</strong> is a possible explanation or a function that describes the given data. A <strong>model</strong>, on the other hand, is a final implementation of a hypothesis that is ready to make predictions. <br>
It is often referred to as the <em>response</em>, <em>outcome</em>, or <em>target variable</em>. Also denoted as <em>y</em> or <em>f(x)</em>.</li>
</ul>
<h2 id="what-are-the-roles-of-the-w-and-b">What are the roles of the <em>w</em> and <em>b</em></h2>
<p>Assume that there are multiple pairs of independent (x) and dependent (y) variables marked on a graph. When a <em>line</em> that traverses through all points is drawn, it results in a single straight line, as illustrated below:</p>
<p><img src="./res/lf-intercept.png" alt="b-intercept"></p>
<p>This <em>line</em> is representative of a graph of a linear function; if each point of that function were marked on the coordinate system, the result would appear as the same line (just infinitely longer).</p>
<p>The point at which the line intersects the vertical axis is referred to as the <em>&lsquo;intercept&rsquo;</em>. It corresponds to the output value (y or h(x)) when the input (x) equals 0. Intercept is the value of <em>b</em> and <em>b</em> is not always intuitive. For example, a relatively accurate model that predicts weight based on height could use non-zero value for the intercept (i.e. for the output when height is 0).</p>
<p><em>w</em> is referred to as the <em>&lsquo;slope&rsquo;</em> because it determines how steep the line is.</p>
<p><img src="./res/lf-slope.png" alt="w-slope"></p>
<p>To calculate the <em>slope</em>, it is necessary to select two points on the <em>line</em> and determine the change in y from one point to the other. A similar procedure is followed for x: calculate the change in x from point 1 to point 2. Then, the change in y is divided by the change in x: (| w = \frac{\Delta y}{\Delta x} |)</p>
<p>When the <em>change in y</em> is divided by the <em>change in x</em>, it will give the change in y for each 1 unit of change in x. In other words, how much y changes if x is increased by 1 (or decreased by 1). <br>
Slope is a function&rsquo;s changing rate.</p>
<p>Below is an another example of how the slope is calculated:</p>
<p><img src="./res/lf-slope-2.png" alt="w-slope-negative"></p>
<blockquote>
<p>$ \frac{y_2 - y_1}{x_2 - x_1} $ and $ \frac{y_1 - y_2}{x_1 - x_2} $ yield the same result</p></blockquote>
<hr>
<h2 id="cost-function">Cost Function</h2>
<p>Suppose some observations have been made and plotted on a graph. Given this, the problem that is intended to be solved with linear regression is to find the optimal line or rather the best-fitting linear function that describes the data:</p>
<p><img src="./res/w-b-line.webp" alt="animated lines"></p>
<p>In order to determine whether one function is better than another, an overall error made by the function is used as a criterion. An error on a graph is a distance between the prediction was made and the actual observed value:</p>
<p><img src="./res/distances.png" alt="distances"></p>
<blockquote>
<p>These distances in machine learning are called <em>&lsquo;residuals&rsquo;</em>. A <em>residual</em> is a difference between an observed value and its corresponding predicted value. <em>Errors</em> are deviations in predictions from the true values that are often unobservable.<br>
In supervised learning data is divided into two subsets: <strong>training</strong> (used for optimizing parameters and training the model) and <strong>testing</strong> (used for evaluating model&rsquo;s real-world performance). <br>
Since errors can be calculated directly from the test set, often distances in the training set are referred to as residuals, while distances in the testing set are called errors. <br>
For simplicity, the term &ldquo;error&rdquo; will be used to refer to both residuals and errors for the remainder of this article.</p></blockquote>
<p><img src="./res/distances-formula.png" alt="how distances are calculated"></p>
<p>Erorrs are calculated using the following formula:</p>
$$
\begin{aligned}
\varepsilon^{(i)} = \hat{y}^{(i)} - y^{(i)}
\end{aligned}
$$<p>where:</p>
<ul>
<li>(| i |) is used to denote an index of observations.</li>
<li>(| \varepsilon^{(i)} |) (epsilon) is an error in the (| i^{th} |) observation.</li>
<li>(| \hat{y} |) (y-hat) is a predicted value for corresponding x value. Alternative notation in this article is h(x).</li>
<li>y is a true observation.</li>
</ul>
<p>How often a model mistakes is measured by a <em>cost function</em>. There are different types of cost functions. Here is the most commonly used cost function <em>Mean Squared Error (MSE)</em>:</p>
$$
\begin{aligned}
J(w,b) = \frac {1} {2m} \sum_{i=1}^{m} (\varepsilon^{(i)})^2
\end{aligned}
$$<p>The Greek letter (| \sum |) (sigma) is used to denote summation. The given formula means &ldquo;sum all squared errors, then divide the sum by <em>2m</em>&rdquo;. As <em><strong>m</strong></em> is a number of observations, it results in an average squared error. Errors are squared so that negative errors (points above the line yield a negative error) do not reduce the cost function when summarised. It is important to note that more significant errors are penalised to a greater extent. Also, squaring and dividing by 2 makes math calculations more straightforward later.</p>
<p>The cost function can be decomposed into simpler elementary terms: <br></p>
$$
\begin{aligned}
    J(w,b) = \frac {1} {2m} \sum_{i=1}^{m} (\varepsilon^{(i)})^2 \allowbreak = \frac {1} {2m} \sum_{i=1}^{m} (\hat{y}^{(i)} - y^{(i)})^2 \allowbreak = \frac {1} {2m} \sum_{i=1}^{m} (h(x^{(i)}) - y^{(i)})^2 \allowbreak = \frac {1} {2m} \sum_{i=1}^{m} (wx^{(i)} + b - y^{(i)})^2
\end{aligned}
$$<hr>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.theme.min.css">
<div id="slope-cost-carousel" class="glide">
  <div class="glide__track" data-glide-el="track">
    <ul class="glide__slides">
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-01.png" alt="Slope Cost 1">
          <p>
            Consider a dataset with independent values x (| \in |) {1, 2, 3} and dependent values y (| \in |) {1, 2, 3}. The data points are marked on the left coordinate system in the above figure. <br> <br>
            The cost function is plotted on the right side. The horizontal axis represents slopes (w) of hypothesis functions, while the vertical axis corresponds to the result of the cost function (J) for a matching slope.
          </p> 
      </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-02.png" alt="Slope Cost 2">
          <p>
            For simplicity, it is assumed here that b = 0. In this case, the result of the cost function of hypothesis h(x) = -(1/2)x is as follows: <br>
            $$
            J(w) = \frac{1}{2m} \sum_{i=1}^{m}(wx^{(i)} + 0 - y^{(i)})^2 \allowbreak = \frac{1}{2 \times 3} \allowbreak \times (( - \frac{1}{2} \times 1 - 1)^2 \allowbreak + ( - \frac{1}{2} \times 2 - 2)^2 \allowbreak + ( - \frac{1}{2} \times 3 - 3)^2) =  \frac{1}{6} \allowbreak \times ( 2.25 + 9 + 20.25 ) = \frac{31.5}{6} = 5.25
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-03.png" alt="Slope Cost 3">
          <p>
            The next assumed slope is 0; Therefore, the hypothesis becomes h(x) = 0x + 0; y is zero for any value of x:
            $$
              J(w) = \frac{1}{2m} \sum_{i=1}^{m}(wx^{(i)} - y^{(i)})^2 = \frac{(0 \cdot 1-1)^2 + (0 \cdot 2-2)^2 + (0 \cdot 3-3)^2}{ 2 \times 3} = \frac{14}{6} \approx 2.3 
            $$
          </p>
      <!-- </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-04.png" alt="Slope Cost 4">
      </li> -->
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-05.png" alt="Slope Cost 5">
          <p>
            You can attempt to calculate the cost for the hypothesis h(x) = (1/2)x, which was calculated in the background. The cost is expected to be a little smaller than 0.6<br> 
            The next presented hypothesis is h(x) = x:
            $$
              J(w) = \frac{1}{2m} \sum_{i=1}^{m}(wx^{(i)} - y^{(i)})^2 = \frac{(1 \times 1-1)^2 + (1 \times 2-2)^2 + (1 \times 3-3)^2}{ 2 \times 3} = \frac{0}{6} = 0 
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-06.png" alt="Slope Cost 6">
          <p>
            The next hypothesis is h(x) = (3\2)x:
            $$
              J(w) = \frac{1}{2m} \sum_{i=1}^{m}(wx^{(i)} - y^{(i)})^2 = \frac{1}{ 2 \times 3} \times ((\frac{3}{2} \times 1-1)^2 + (\frac{3}{2} \times 2-2)^2 + (\frac{3}{2} \times 3-3)^2) = \frac{0.25 + 1 + 2.25}{6} \approx 0.583
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-07.png" alt="Slope Cost 7">
          <p>
            After corresponding calculations for slopes 2 and 2.5, the final graph will look like the one above.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/slope-cost/slope-cost-08.png" alt="Slope Cost 8">
          <p>
            In the case of the results of the cost function being plotted on a graph for each slope value between -0.5 and 2.5, the result would be a very similar (or even identical) 'U'-shaped line.
          </p>
          <p class="text-center">↓</p>
          <p class="text-center">↓</p>
      </li>
    </ul>
  </div>
  <div class="glide__arrows relative flex justify-between items-center p-2" data-glide-el="controls">
    <button class="glide__arrow glide__arrow--left px-2 py-1 bg-transparent border border-gray-200 text-white hover:border-white" data-glide-dir="<">Prev</button>
    <button class="glide__arrow glide__arrow--right px-2 py-1 bg-transparent border border-gray-200 text-white hover:border-white" data-glide-dir=">">Next</button>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@glidejs/glide"></script>
<script>
  new Glide('#slope-cost-carousel', {
    type: 'carousel',
    // autoplay: 3000,
    // hoverpause: true
  }).mount();
</script>
<!-- <style>
/* Container for carousel */
/* #slope-cost-carousel .glide {
  position: relative;
  overflow: visible;
} */

/* Force consistent slide heights */
/* #slope-cost-carousel .glide__slide {
  display: flex;
  flex-direction: column;
  height: auto !important; 
  min-height: 0;
} */

/* Image container with aspect ratio */
/* #slope-cost-carousel .image-container {
  position: relative;
  aspect-ratio: 3/2;
  width: 100%;
} */

/* Actual image styling */
/* .glide__slide img {
  width: 100%;
  height: 100%;
  object-fit: contain;
} */

/* Paragraph styling with fixed height */
#slope-cost-carousel .glide__slide p {
  flex: 0 0 auto; 
  max-height: 200px; /* Adjust based on needs */
  overflow-y: auto; /* Make content scrollable if needed */
  margin: 0;
  padding: 0.5rem;
}

/* Button positioning */
/* #slope-cost-carousel .glide__arrows {
  position: absolute;
  top: 2rem;
  left: 0;
  right: 0;
  padding: 0 1rem;
  z-index: 2;
  pointer-events: none;
} */

#slope-cost-carousel .glide__arrow {
  pointer-events: all; /* Re-enable clicks for buttons */
  /* margin: 0;
  transform: translateY(50%); Center vertically */
}

/* #slope-cost-carousel .glide__arrow--left {
  float: left;
}

#slope-cost-carousel .glide__arrow--right {
  float: right;
} */
</style> -->
<hr>
<p>In simple linear regression the optimal line that best fits the data is determined by minimising the cost function. While it is straightforward to identify this line in simple/univariate linear regression by brute force, this becomes impractical when there are more than two independent variables; each independent variable requires an additional axis, or dimension, on a graph. Although computers can visualise such graphs, it is impossible to understand what exactly is being plotted. <br>
One of the methods used to minimise the cost function is called <em>&lsquo;gradient descent&rsquo;</em>.</p>
<h2 id="gradient-descent">Gradient Descent</h2>
<p><strong>Gradient descent</strong> is an iterative optimisation algorithm for minimising a differentiable function.<br>
It requires:</p>
<ol>
<li>Calculate the function&rsquo;s gradient. The resulting vector of partial derivatives is referred to as the <em>&lsquo;gradient&rsquo;</em>.</li>
<li>Update parameters based on the gradient.</li>
<li>Repeat until convergence (very small change in cost or gradient).</li>
</ol>
<p>Again the intercept b is 0 for now. For the cost function:
</p>
$$
J(w) = \frac {1} {2m} \sum_{i=1}^{m} (wx^{(i)}-y^{(i)})^2
$$<p>the derivative is the following:</p>
$$
\frac{dJ}{dx} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)}-y^{(i)})x^{(i)}
$$<p>Since taking derivative is applying the right formulas, there is no value in presenting the exact path from the cost function. So I didn&rsquo;t.</p>
<p>The update rule is:</p>
$$
w_{new} := w - \alpha \times \frac{dJ}{dx}
$$<p>where (| \alpha |) is referred to as a <strong>&rsquo;learning rate&rsquo;</strong>. It is just a small number that scales the derivative. It is usually set to 0.01, when features are scaled.</p>
<hr>
<div id="gradient-descent-carousel" class="glide">
  <div class="glide__track" data-glide-el="track">
    <ul class="glide__slides">
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-01.png" alt="Gradient Descent 1">
          <p>
            The dataset is the same.  
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-02.png" alt="Gradient Descent 2">
          <p>
            For better understanding, the cost function is plotted on the graph.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-03.png" alt="Gradient Descent 3">
          <p>
            Usually starting hypothesis slope is 0.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-04.png" alt="Gradient Descent 4">
          <p>
            Suppose the cost is calculated for another hypothesis. The slope of this hypothesis differs so little from the previous one that the resulting costs are almost identical. Over this interval, the cost function behaves as a linear function. <br>
            A line that connects these costs is plotted on a graph. <br>
            This line is called a <i>'tangent line'</i>. The <b>tangent line</b> is a line that just touches a curve without crossing it.<br>
            You can find out more about tangent line in <a href="https://youtu.be/O_cwTAfjgAQ?si=KSVlArnSl_gwfovZ" target="_blank">this YouTube video</a>.
          </br>
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-05.png" alt="Gradient Descent 5">
          <p>
            Drawing the tangent line allows a direct calculation of its slope. In other words, the rate of change of the cost function can be defined for each value of w.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-06.png" alt="Gradient Descent 6">
          <p>
            Calculating the derivative gives the rate of change for a given w:
            $$
            \frac{dJ}{dx} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)}-y^{(i)})x^{(i)} = \frac{1}{3} \times ((0 \cdot 1 - 1) \cdot 1 +  (0 \cdot 2 - 2) \cdot 2 + (0 \cdot 3 - 3) \cdot 3) = \frac{1}{3} \times (-1 - 4 -9) \approx -4.7 
            $$
            Apply the update rule with the learning rate 0.01:
            $$
            w_{new} := w - \alpha \times \frac{dJ}{dw} \Rightarrow w = 0 - 0.1 \times (-4.7) = 0 + 0.47
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-07.png" alt="Gradient Descent 7">
          <p>
            The second iteration:
            $$
            \frac{dJ}{dx} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)}-y^{(i)})x^{(i)} = \frac{1}{3} \times ((0.47 \cdot 1 - 1) \cdot 1 +  (0.47 \cdot 2 - 2) \cdot 2 + (0.47 \cdot 3 - 3) \cdot 3) = \frac{1}{3} \times (-0.53 -2.12 -4.77) \approx -2.47
            $$
            $$
            w_{new} := w - \alpha \times \frac{dJ}{dw} \Rightarrow w = 0.47 - 0.1 \times (-2.5) = 0.47 + 0.247 = 0.717
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-08.png" alt="Gradient Descent 8">
          <p>
            Other iterations are calculated in the same way.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-09.png" alt="Gradient Descent 9">
          <p>
            As the gradient descent approaches the minimum point, the rate of change of the cost function (or the derivative) becomes smaller and the update steps become smaller.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-10.png" alt="Gradient Descent 10">
          <p>
            On the other hand, when a parameter is greater than a minimum point, the slope of the tangent line is positive. Updating w, in this case, makes it smaller:
            $$
            \frac{dJ}{dx} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)}-y^{(i)})x^{(i)} = \frac{1}{3} \times ((2 \cdot 1 - 1) \cdot 1 +  (2 \cdot 2 - 2) \cdot 2 + (2 \cdot 3 - 3) \cdot 3) = \frac{1}{3} \times (1 + 4 + 9) \approx 4.7 
            $$
            Update:
            $$
            w_{new} := w - \alpha \times \frac{dJ}{dw} \Rightarrow w = 2 - 0.1 \times (4.7) = 2 - 0.47 \approx 1.5
            $$
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-11.png" alt="Gradient Descent 11">
          <p>
            Just to be clear, when training models these calculations are never made by a human nowadays.
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-12.png" alt="Gradient Descent 12">
          <p>
            The iterations repeated until convergence. There are 2 types of convergence: gradient-based and cost-based. <br>
            The derivative or the cost are monitored, if derivative is very close to 0 or the cost difference between iterations are too small, the parameters considered as converged. <br>
            Sometimes, they are combined. <br> 
            The convergence threshold typically in the range of (| 10^{-4} |) to (| 10^{-8} |).
          </p>
      </li>
      <li class="glide__slide">
          <img src="./res/gradient-descent/gradient-descent-13.png" alt="Gradient Descent 13">
          <p>
            At minimum point tangent line is horizontal and its slope is 0.
          </p>
      </li>
    </ul>
  </div>
  <div class="glide__arrows relative flex justify-between items-center p-2" data-glide-el="controls">
    <button class="glide__arrow glide__arrow--left px-2 py-1 bg-transparent border border-gray-200 text-white hover:border-white" data-glide-dir="<">Prev</button>
    <button class="glide__arrow glide__arrow--right px-2 py-1 bg-transparent border border-gray-200 text-white hover:border-white" data-glide-dir=">">Next</button>
  </div>
</div>
<style>
/* Paragraph styling with fixed height */
#gradient-descent-carousel .glide__slide p {
  flex: 0 0 auto; 
  max-height: 180px; /* Adjust based on needs */
  overflow-y: auto; /* Make content scrollable if needed */
  margin: 0;
  padding: 0.5rem;
}
#gradient-descent-carousel .glide__arrow {
  pointer-events: all; /* Re-enable clicks for buttons */
  /* margin: 0;
  transform: translateY(50%); Center vertically */
}
</style>
<script>
  new Glide('#gradient-descent-carousel', {
    type: 'carousel',
  }).mount();
</script>
<hr>
<p>For non-zero intercept one more dimention should be introduced on the cost function&rsquo;s graph:</p>
<p><img src="./res/gradient-descent-3d-surface.png" alt="gradient descent 3d surface"></p>
<p>It is the cost function&rsquo;s surface for a data for which best fit is y = 2x + 1.<br>
Red points here represent each combination of slope and intercept and corresponding cost.</p>
<p>Since there are two values on which cost function depends, for the cost function:
</p>
$$
J(w, b) = \frac{1}{2m} \sum_{i=1}^{m} (wx^{(i)} + b - y^{(i)})^2
$$<p>should be taken the partial derivatives:</p>
<ol>
<li>$$ \frac{\partial J}{\partial w} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)} + b - y^{(i)})x^{(i)} $$</li>
<li>$$ \frac{\partial J}{\partial b} = \frac{1}{m} \sum_{i=1}^{m} (wx^{(i)} + b - y^{(i)}) $$</li>
</ol>
<p>The parameters of hypothesis should be updated simultaneously:</p>
<ol>
<li>$$ w_{new} := w - \alpha \times \frac{dJ}{dw} $$</li>
<li>$$ b_{new} := w - \alpha \times \frac{dJ}{db} $$</li>
</ol>

            </div>
            
        </div>
    </div>

        </main>
        
<footer class="mt-32 text-center">
    <div class="max-w-3xl mx-auto">
        <div class="border-t border-gray-800 pt-5">
            <div class="flex flex-col items-center justify-center gap-2">                
                <p class="text-gray-500 text-xm ">© 2025 Hafizulloh Ergashev</p>
                <p class="text-gray-500 text-xm pb-12">Built using <a href="https://gohugo.io/" target="_blank" class="animated-link text-gray-400 hover:text-gray-200">Hugo</a>.</p>
            </div>
        </div>
    </div>
</footer>

<style>
    .animated-link {
        position: relative;
        display: inline-flex;
        align-items: center;
    }
    
    .animated-link::after {
        content: '';
        position: absolute;
        width: 0;
        height: 1px;
        bottom: -1px;
        left: 0;
        background-color: #ffffff;
        transition: width 0.3s ease-in-out;
    }
    
    .animated-link:hover::after {
        width: 100%;
    }
</style> 
    </body>
</html> 