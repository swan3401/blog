<!DOCTYPE html>
<html lang="en" class="dark">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Multiple Linear Regression - Hafizulloh Ergashev</title>
        


        <script>
            tailwind.config = {
              darkMode: 'class',
              plugins: [tailwindcssTypography],
            }
        </script>
        <script src="https://cdn.tailwindcss.com?plugins=typography"></script>


        
        <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313/favicon_io/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon_io/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon_io/favicon-16x16.png">
        <link rel="manifest" href="http://localhost:1313/favicon_io/site.webmanifest">        
        <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
        <link rel="preload" href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" as="style">
        
        
        <style>
            html, body {
                background-color: #121212;
                color: #f3f4f6;
            }            
            .border {
                border-color: #374151;
            }            
            .carousel-item {
                display: inline-block;
                margin: 0 1rem;
            }            
            .flex {
                display: flex;
            }
            .flex-col {
                flex-direction: column;
            }
            
            @media (min-width: 768px) {
                .md\:flex-row {
                    flex-direction: row;
                }
            }
            
            .tech-carousel {
                overflow: hidden;
                width: 100%;
                padding: 1rem 0;
            }
            
            .carousel-track {
                white-space: nowrap;
            }
        </style>
        
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
        <script>
            
            if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        </script>
        <style>
            :root {
                color-scheme: dark;
            }
            
            body {
                @apply bg-[#121212] text-gray-100;
            }

            .tech-icon {
                filter: grayscale(100%) brightness(200%);
                transition: all 0.3s ease;
            }
            .tech-icon:hover {
                filter: none;
            }
            
            @keyframes scroll {
                0% {
                    transform: translateX(0);
                }
                100% {
                    transform: translateX(-100%);
                }
            }
            
            .tech-carousel {
                width: 100%;
                padding: 1rem 0;
            }
            
            .tech-track {
                width: fit-content;
                animation: scroll 20s linear infinite;
            }
            
            .tech-track:hover {
                animation-play-state: paused;
            }
            
            .tech-slide {
                float: left;
            }
        </style>

        

        
        








  <script>
    window.MathJax = {
      loader: { 
        load: ['input/tex', 'output/chtml', 'ui/menu'] 
      },
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)'], ['(|','|)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        tags: 'ams',
        macros: {
          brk: '\\allowbreak'
        },
        
        
        
        
        
        
        
        
        
        
      },
      chtml: {
        
        displayAlign: 'center',
        displayIndent: '0',
        displayOverflow: 'linebreak',
        linebreaks: {
          automatic: true,
          width: 'container',
          lineleading: 0.2,
          
          
          
          
          
          
          
          
        }
      },
      svg: {
        linebreaks: { automatic: true }
      }
    };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0-beta.3/tex-mml-chtml.js"></script>
    

    






        

    </head>
    <body class="min-h-screen bg-[#121212] text-gray-100">
        
<head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C0RTF18BT4"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-C0RTF18BT4');
    </script>
    
    <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Space Grotesk', sans-serif;
        }
    </style>
</head>
<header class="py-6 relative">
    <div class="max-w-6xl mx-auto px-4">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="flex justify-between items-center">
                <a href="http://localhost:1313/" class="text-xl font-bold text-white hover:text-gray-300 transition-colors duration-300">
                    Hafizulloh Ergashev
                </a>
                
                <button id="mobile-menu-button" class="md:hidden text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>            
            
            <nav class="hidden md:flex flex-wrap justify-center items-center gap-4 md:gap-6">
                
                
                <a href="http://localhost:1313/about/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="http://localhost:1313/blogs/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="http://localhost:1313/contact/" class="inline-block text-lg text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="hidden md:flex justify-end">
                <div class="flex items-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>

    
    <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden transition-all duration-300">
        <div class="flex flex-col h-full">
            <div class="flex justify-between items-center p-6 border-b border-gray-800">
                <span class="text-xl font-bold text-white">Menu</span>
                <button id="mobile-menu-close" class="text-gray-300 hover:text-white focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <nav class="flex flex-col p-6 space-y-4">
                
                <a href="http://localhost:1313/about/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">About</a>
                
                <a href="http://localhost:1313/blogs/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Blogs</a>
                
                <a href="http://localhost:1313/contact/" class="text-xl text-gray-300 hover:text-white transition-colors duration-300 ">Contact</a>
                
            </nav>
            <div class="mt-auto p-6 border-t border-gray-800">
                <div class="flex items-center justify-center">
                    <span class="text-lg text-gray-300 mr-2">Local Time:</span>
                    <div id="mobile-local-time" class="text-lg text-gray-300"></div>
                </div>
            </div>
        </div>
    </div>
</header>

<script>
    
    function updateLocalTime() {
        const timeElements = document.querySelectorAll('#local-time, #mobile-local-time');
        timeElements.forEach(element => {
            if (element) {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                element.textContent = timeString;
            }
        });
    }
    updateLocalTime();
    setInterval(updateLocalTime, 1000);

    
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const mobileMenu = document.getElementById('mobile-menu');

    function toggleMobileMenu() {
        const isHidden = mobileMenu.classList.contains('hidden');
        if (isHidden) {
            mobileMenu.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; 
        } else {
            mobileMenu.classList.add('hidden');
            document.body.style.overflow = ''; 
        }
    }

    mobileMenuButton.addEventListener('click', toggleMobileMenu);
    mobileMenuClose.addEventListener('click', toggleMobileMenu);

    
    const mobileMenuLinks = mobileMenu.querySelectorAll('a');
    mobileMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
            toggleMobileMenu();
        });
    });

    
    const themeToggleBtn = document.getElementById('theme-toggle');
    if (themeToggleBtn) {
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
            themeToggleDarkIcon.classList.add('hidden');
        } else {
            themeToggleLightIcon.classList.add('hidden');
            themeToggleDarkIcon.classList.remove('hidden');
        }

        themeToggleBtn.addEventListener('click', function() {
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });
    }
</script> 
        <main>
            
    <div class="w-full md:w-4/5 lg:w-3/4 xl:w-2/3 mx-auto py-12">
        <div class="max-w-5xl mx-auto p-8 border border-gray-800 rounded-2xl bg-[#121212]">
            <h1 class="text-4xl font-bold mb-4">Multiple Linear Regression</h1>
            
                <div class="flex items-center gap-4 mb-8 text-gray-400">
                    <time datetime="2025-05-23">May 23, 2025</time>
                    <div class="flex gap-2">
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Generalized Linear Models</span>
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Linear regression</span>
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Gradient Descent</span>
                        
                        <span class="px-2 py-1 bg-gray-800 rounded-md text-xs font-medium text-gray-300">Normal Equation</span>
                        
                    </div>
                </div>
            

            
              
            <div class="prose prose-invert max-w-none post-content">
                <p><strong>Previous article:</strong> <a href="../../blogs/simple-linear-regression/">Simple Linear Regression</a></p>
<p><strong>Multiple linear regression</strong> (MLR) is an extension of simple linear regression (SLR) that enables multiple independent variables to be included in the prediction of the dependent variable.</p>
<p>The model was previously represented as follows:</p>
$$
    \hat{y} = wx + b
$$<p>where:</p>
<ul>
<li><strong>x</strong> is an input to the model.</li>
<li><strong>w</strong> is a coefficient that defines how the target variable responds to each <em>unit change in x</em>.</li>
<li><strong>b</strong> is the base value of the outcome when <em>x = 0</em> (i.e. outcome unaffected by the independent variable). However, its more important role is positioning the best fitting line along the y-axis (along axis that represents the outcome).</li>
</ul>
<p>Multiple linear regression keeps the pattern and represented as:</p>
$$
    \hat{y} = \vec{w} \cdot \vec{x} + b \\ 
    \text{or} \\
    \hat{y} = w_1 x_1 + w_2 x_2 + \cdots + w_n x_n + b
$$<blockquote>
<p>These two are the same equation</p></blockquote>
<p>where:</p>
<ul>
<li><strong>n</strong> is the number of independent variables.</li>
<li><strong>$ \vec{x} $</strong> is a vector containing the independent variables: $ \vec{x} = \begin{bmatrix} x_1 & x_2 & \cdots & x_n  \end{bmatrix} $.</li>
<li><strong>$ \vec{w} $</strong> is a vector containing the matching coefficients for the independent variables: $ \vec{w} = \begin{bmatrix} w_1 & w_2 & \cdots & w_n  \end{bmatrix} $.</li>
<li><strong>b</strong> has the same role as in SLR. However, multiple linear regression is about hyperplanes rather than a straight line (actually, lines are hyperplanes in two dimensions). Visualising the predictions of an MLR model requires an additional dimension (axis) for each parameter. The best meaningful plot that can be drawn is a plane in three dimensions, where <em>b</em> postions the plane along the dependent variable&rsquo;s axis.</li>
</ul>
<p>Below is example of a multiple linear regression model:</p>
$$
\hat{y}^{(i)} =  w_1 x_1^{(i)} + w_2 x_2^{(i)} + w_3 x_3^{(i)} + b
$$$$
\text{Predicted price} = 120 \times \text{SqFt} + 15 \space 000 \times \text{Bedrooms} - 800 \times \text{Age} + 50 \space 000
$$<p>This way, it is intuitive that:</p>
<ul>
<li>the price of a house increases by $120 for each additional square foot.</li>
<li>each additional bedroom increases the price by $15,000.</li>
<li>each year counted from the year of construction reduces the price by $800.</li>
<li><em>b</em> is the base price.</li>
</ul>
<table>
  <thead>
      <tr>
          <th>House ID</th>
          <th>SqFt ( $x_1$ )</th>
          <th>Bedrooms ( $x_2$ )</th>
          <th>Age ( $x_3$ )</th>
          <th>Predicted price ( $\hat{y}$ )</th>
          <th>Price ( $y$ )</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>1 500</td>
          <td>3</td>
          <td>10</td>
          <td>267 000</td>
          <td>267 700</td>
      </tr>
      <tr>
          <td>2</td>
          <td>2 000</td>
          <td>4</td>
          <td>5</td>
          <td>346 000</td>
          <td>345 800</td>
      </tr>
      <tr>
          <td>3</td>
          <td>1 200</td>
          <td>2</td>
          <td>20</td>
          <td>208 000</td>
          <td>208 500</td>
      </tr>
      <tr>
          <td>4</td>
          <td>1 800</td>
          <td>3</td>
          <td>8</td>
          <td>304 600</td>
          <td>303 100</td>
      </tr>
      <tr>
          <td>5</td>
          <td>2 200</td>
          <td>4</td>
          <td>12</td>
          <td>364 400</td>
          <td>366 700</td>
      </tr>
      <tr>
          <td>6</td>
          <td>1 600</td>
          <td>3</td>
          <td>15</td>
          <td>275 000</td>
          <td>274 750</td>
      </tr>
      <tr>
          <td>7</td>
          <td>1 100</td>
          <td>2</td>
          <td>25</td>
          <td>192 000</td>
          <td>192 900</td>
      </tr>
      <tr>
          <td>8</td>
          <td>2 500</td>
          <td>5</td>
          <td>7</td>
          <td>419 400</td>
          <td>418 400</td>
      </tr>
      <tr>
          <td>9</td>
          <td>1 400</td>
          <td>3</td>
          <td>18</td>
          <td>248 600</td>
          <td>249 000</td>
      </tr>
      <tr>
          <td>10</td>
          <td>1 900</td>
          <td>4</td>
          <td>10</td>
          <td>330 000</td>
          <td>329 400</td>
      </tr>
  </tbody>
</table>
<p>In this article and those that follow:</p>
<ul>
<li>$ x_j $   &mdash;   $ j^{th} $ feature :    $ x_2 = \begin{bmatrix} 3 \\ 4 \\ \vdots \\ 4 \end{bmatrix} $</li>
<li>$ x^{(i)} $   &mdash;   all the values of the independent variables in $ i^{th} $ observation :    $ x^{(3)} = \begin{bmatrix} 1 200 & 2 & 20  \end{bmatrix} $</li>
<li>$ x_{j}^{(i)} $   &mdash;   a value of feature <em>j</em> in observation <em>i</em> :    $ x_{2}^{(9)} = 3 $</li>
</ul>
<h2 id="cost-function">Cost function</h2>
<p>In the article on simple linear regression, the cost function, which measures the sum of squared errors, was presented as follows:
</p>
$$
    J(w,b) = \frac { 1 } { 2m } \sum_{i=1}^{m} ( wx^{(i)} + b - y^{(i)} )^2
$$<p>The cost funtion of multiple linear regression does the same and remains almost unchanged:
</p>
$$
J(\vec{w},b) = \frac { 1 } { 2m } \sum_{i=1}^{m} ( \vec{w} \cdot \vec{x}^{(i)} + b - y^{(i)} )^2
$$<h2 id="gradient-descent">Gradient descent</h2>
<p>Gradient descent is an optimisation algorithm that iteratively adjusts the parameters of a function — in the case of MLR, the parameters are the slopes ( $\vec{w}$ ) and the intercept ( <em>b</em> ) — towards optimal values (i.e. towards values that minimise the cost function).<br>
Gradient descent can be applied to any differentiable function to locate its minimum point. Thus, it is widely used, from optimising regression models to training neural networks.<br>
The algorithm is covered more in detail in the <a href="../../blogs/simple-linear-regression/">article on SLR</a>.</p>
<p>Here is how gradient descent is implemented:</p>
<ol>
<li>Calculate the gradient of the cost function.</li>
<li>Update the parameters based on the gradient.</li>
<li>Repeat steps 1 and 2 until convergence (i.e. until point where updating the parameters reduces the cost function too little).</li>
</ol>
<hr>
<p>The <strong>gradient</strong> of a function is a vector containing all the values resulting from the calculation of all its partial derivatives.<br>
The partial derivative is calculated separately for each parameter of a function. Each partial derivative yields a number that represents the direction and rate of change of the (cost) function.<br>
For instance, if the partial derivative were taken with respect to the coefficient of the first feature ( $w_1$ ) and the resulting number were 2, this would indicate that increasing the coefficient ( $w_1$ ) would also increase the cost function. If the number were -10, this would mean that decreasing the coefficient ( $w_1$ ) would increase the cost function and to a much greater extent.<br>
Gradient descent aims to reduce the partial derivative of each parameter to zero, in order to minimise the cost function.</p>
<p>Here is the partial derivatives of an SLR model:</p>
$$ \frac{\partial J}{ \partial w} = \frac { 1 } { m } \sum_{i=1}^{m} ( wx^{(i)} + b - y^{(i)} )x^{(i)} $$<p>
</p>
$$ \frac{\partial J}{ \partial b} = \frac{ 1 } { m } \sum_{i=1}^{m} (wx^{(i)} + b - y^{(i)}) $$<p>For multiple linear regression again it is very similar:</p>
$$
    \frac{\partial J}{\partial w_1} = \frac{1}{m} \sum_{i=1}^{m} (\vec{w} \cdot \vec{x}^{(i)} + b - y^{(i)})x_1^{(i)} \\
    \vdots \\ 
    \frac{\partial J}{\partial w_n} = \frac { 1 } { m } \sum_{i=1}^{m} ( \vec{w} \cdot \vec{x}^{(i)} + b - y^{(i)} )x_n^{(i)}
$$<p>
</p>
$$ \frac{\partial J}{\partial b} = \frac{1}{m} \sum_{i=1}^{m} (\vec{w} \cdot \vec{x}^{(i)} + b - y^{(i)}) $$<hr>
<p>It is not hard to adjust the parameters after partial derivatives were taken. Here are the update rules for an SLR:</p>
$$ w_{new} := w - \alpha \times \frac{dJ}{dw} $$<p>
</p>
$$ b_{new} := b - \alpha \times \frac{dJ}{db} $$<p>These rules are applied simultaneously after each iteration. $ \alpha $ is a small number that scales the derivative. It is referred to as the <em>learning rate</em>.<br>
In the first iteration, the parameters <em>w</em> and <em>b</em> are randomly guessed, they are usually set to 0; in SLR and MLR, they only affect the number of iterations until convergence.<br>
If the derivatives are positive, updating the parameters decreases them. If the derivatives are negative, adjusting the parameters increases them. This is the intended behaviour.</p>
<p>Update rules for an MLR:</p>
$$
    w_1 := w_1 - \alpha \times \frac{\partial J}{\partial w_1} \\ 
    \vdots \\ 
    w_n := w_n - \alpha \times \frac{\partial J}{\partial w_n}
$$<p>
</p>
$$
    b := b - \alpha \times \frac{\partial J}{\partial b}
$$<p>The default values for the learning rate are <em>0.01</em> or <em>0.1</em>. If the features are not scaled the model becomes very sensitive to the learning rate. While there are approaches to adjust $ \alpha $, brute force (gradually increasing/decreasing it, trying few numbers) is also an option. <br>
If learning rate is too big, gradient descent could not find the best hyperplane. If it is too small, it might take hours to train the model.</p>

            </div>
            
        </div>
    </div>

        </main>
        
<footer class="mt-32 text-center">
    <div class="max-w-3xl mx-auto">
        <div class="border-t border-gray-800 pt-5">
            <div class="flex flex-col items-center justify-center gap-2">                
                <p class="text-gray-500 text-xm ">© 2025 Hafizulloh Ergashev</p>
                <p class="text-gray-500 text-xm pb-12">Built using <a href="https://gohugo.io/" target="_blank" class="animated-link text-gray-400 hover:text-gray-200">Hugo</a>.</p>
            </div>
        </div>
    </div>
</footer>

<style>
    .animated-link {
        position: relative;
        display: inline-flex;
        align-items: center;
    }
    
    .animated-link::after {
        content: '';
        position: absolute;
        width: 0;
        height: 1px;
        bottom: -1px;
        left: 0;
        background-color: #ffffff;
        transition: width 0.3s ease-in-out;
    }
    
    .animated-link:hover::after {
        width: 100%;
    }
</style> 
    </body>
</html> 